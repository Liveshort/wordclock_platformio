#include <Arduino.h>

#include "main.h"
#include "palettes.h"

DEFINE_GRADIENT_PALETTE(White_p){0,   255, 255, 255, 17,  255, 255, 255, 34,  255, 255, 255, 51,  255, 255, 255,
                                 68,  255, 255, 255, 85,  255, 255, 255, 102, 255, 255, 255, 119, 255, 255, 255,
                                 136, 255, 255, 255, 153, 255, 255, 255, 170, 255, 255, 255, 187, 255, 255, 255,
                                 204, 255, 255, 255, 221, 255, 255, 255, 238, 255, 255, 255, 255, 255, 255, 255};

DEFINE_GRADIENT_PALETTE(CottonCandy_p){0,   255, 34,  87,  17,  255, 61,  97,  34,  255, 123, 100, 51,  255, 192, 112,
                                       68,  255, 207, 122, 85,  255, 195, 126, 102, 254, 177, 123, 119, 245, 143, 117,
                                       136, 244, 139, 116, 153, 254, 176, 123, 170, 255, 194, 126, 187, 255, 208, 122,
                                       204, 255, 193, 113, 221, 255, 129, 101, 238, 255, 63,  97,  255, 255, 36,  87};

DEFINE_GRADIENT_PALETTE(GoldenSun_p){0,   248, 135, 0, 17,  248, 136, 0, 34,  249, 141, 0, 51,  250, 148, 0,
                                     68,  251, 158, 0, 85,  253, 167, 0, 102, 254, 176, 0, 119, 255, 185, 0,
                                     136, 255, 185, 0, 153, 254, 176, 0, 170, 253, 167, 0, 187, 251, 158, 0,
                                     204, 250, 149, 0, 221, 249, 141, 0, 238, 248, 136, 0, 255, 248, 135, 0};

DEFINE_GRADIENT_PALETTE(SunnyDay_p){0,   255, 252, 49,  17,  242, 255, 49,  34,  202, 255, 51,  51,  151, 255, 52,
                                    68,  87,  255, 53,  85,  48,  255, 86,  102, 39,  255, 131, 119, 39,  255, 133,
                                    136, 39,  255, 133, 153, 39,  255, 132, 170, 47,  255, 88,  187, 85,  255, 53,
                                    204, 149, 255, 52,  221, 200, 255, 51,  238, 241, 255, 49,  255, 255, 252, 49};

DEFINE_GRADIENT_PALETTE(BlueSky_p){0,   16, 213, 255, 17,  26, 208, 255, 34,  37, 202, 255, 51,  46, 196, 255,
                                   68,  57, 188, 255, 85,  66, 179, 255, 102, 77, 166, 255, 119, 86, 151, 255,
                                   136, 86, 150, 255, 153, 77, 166, 255, 170, 66, 179, 255, 187, 57, 187, 255,
                                   204, 47, 195, 255, 221, 37, 202, 255, 238, 26, 208, 255, 255, 16, 213, 255};

DEFINE_GRADIENT_PALETTE(BloodyRed_p){0,   246, 76, 0, 17,  246, 73, 0, 34,  246, 63, 0, 51,  247, 52, 0,
                                     68,  247, 42, 0, 85,  247, 29, 0, 102, 248, 17, 0, 119, 248, 5,  0,
                                     136, 248, 5,  0, 153, 248, 17, 0, 170, 247, 29, 0, 187, 247, 41, 0,
                                     204, 247, 52, 0, 221, 246, 63, 0, 238, 246, 73, 0, 255, 246, 76, 0};

DEFINE_GRADIENT_PALETTE(ForestGreen_p){0,   5,   209, 0,  17,  26,  219, 0,  34,  47,  228, 0,  51,  59,  239, 0,
                                       68,  74,  249, 0,  85,  87,  255, 4,  102, 102, 255, 14, 119, 113, 255, 23,
                                       136, 113, 255, 23, 153, 103, 255, 14, 170, 88,  255, 4,  187, 74,  249, 0,
                                       204, 60,  240, 0,  221, 47,  229, 0,  238, 27,  219, 0,  255, 6,   210, 0};

DEFINE_GRADIENT_PALETTE(Peach_p){0,   244, 118, 106, 17,  243, 117, 103, 34,  244, 125, 90,  51,  244, 136, 76,
                                 68,  246, 146, 61,  85,  248, 161, 42,  102, 251, 175, 23,  119, 253, 189, 7,
                                 136, 253, 189, 7,   153, 251, 176, 22,  170, 248, 161, 41,  187, 246, 147, 60,
                                 204, 244, 137, 76,  221, 244, 126, 90,  238, 243, 117, 103, 255, 244, 118, 106};

DEFINE_GRADIENT_PALETTE(TropicalSea_p){0,   0,  163, 230, 17,  0, 180, 227, 34,  0, 199, 225, 51,  0,  223, 217,
                                       68,  0,  237, 199, 85,  0, 250, 175, 102, 9, 255, 149, 119, 23, 255, 124,
                                       136, 23, 255, 123, 153, 9, 255, 148, 170, 0, 251, 175, 187, 0,  237, 198,
                                       204, 0,  223, 217, 221, 0, 200, 225, 238, 0, 180, 227, 255, 0,  164, 230};

const PaletteInfo PALETTES[] = {{"Wit", CRGBPalette16(White_p)},
                                {"Suikerspin", CRGBPalette16(CottonCandy_p)},
                                {"Gouden uur", CRGBPalette16(GoldenSun_p)},
                                {"Zomerdag", CRGBPalette16(SunnyDay_p)},
                                {"Blauwe lucht", CRGBPalette16(BlueSky_p)},
                                {"Bloedrood", CRGBPalette16(BloodyRed_p)},
                                {"Bosgroen", CRGBPalette16(ForestGreen_p)},
                                {"Perzik", CRGBPalette16(Peach_p)},
                                {"Caribische zee", CRGBPalette16(TropicalSea_p)}};

const uint8_t PALETTE_COUNT = sizeof(PALETTES) / sizeof(PALETTES[0]);

String palette_json_for(uint8_t idx) {
    String s = "{\"name\":\"";
    s += PALETTES[idx].name;
    s += "\",\"colors\":[";
    for (int i = 0; i < 16; ++i) {
        CRGB c = ColorFromPalette(PALETTES[idx].pal, (uint8_t) (i * 16), 255, LINEARBLEND);
        char buf[16];
        sprintf(buf, "\"#%02X%02X%02X\"", c.r, c.g, c.b);
        s += buf;
        if (i < 15)
            s += ",";
    }
    if (USER_SETTINGS[ACTIVE_PALETTES] & (1 << idx))
        s += "],\"active\":true}";
    else
        s += "],\"active\":false}";

    return s;
}
